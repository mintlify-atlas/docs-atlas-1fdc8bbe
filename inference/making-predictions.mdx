---
title: Making predictions on MNIST test set
description: Learn how to evaluate your trained neural network against the MNIST test dataset and measure accuracy
---

After training your neural network, you can evaluate its performance on the MNIST test dataset to measure accuracy. The prediction process loads the trained model weights and runs inference on 10,000 test images.

## Running predictions

<Steps>
  <Step title="Train your model first">
    Before making predictions, ensure you have a trained model with saved weights in the `data/` directory:
    
    ```bash
    go run cmd/main.go -mnist train
    ```
    
    This creates `data/hweights.model` and `data/oweights.model` files.
  </Step>
  
  <Step title="Run the prediction command">
    Execute the prediction against the MNIST test set:
    
    ```bash
    go run cmd/main.go -mnist predict
    ```
    
    <Info>
      The test dataset should be located at `mnist_dataset/mnist_test.csv` relative to your working directory.
    </Info>
  </Step>
  
  <Step title="Review the results">
    The command outputs the time taken and the accuracy score:
    
    ```
    Time taken to check: 2.5s
    score: 9700
    ```
    
    With proper training, you should achieve approximately 97% accuracy (9,700 out of 10,000 correct predictions).
  </Step>
</Steps>

## How prediction works

The `mnistPredict` function in `/cmd/main.go:88` implements the evaluation logic:

```go
func mnistPredict(net *perceptron.Network) {
    t1 := time.Now()
    checkFile, _ := os.Open("mnist_dataset/mnist_test.csv")
    defer checkFile.Close()

    score := 0
    r := csv.NewReader(bufio.NewReader(checkFile))
    for {
        record, err := r.Read()
        if err == io.EOF {
            break
        }
        inputs := make([]float64, net.Inputs)
        for i := range inputs {
            if i == 0 {
                inputs[i] = 1.0
            }
            x, _ := strconv.ParseFloat(record[i], 64)
            inputs[i] = (x / 255.0 * 0.99) + 0.01
        }
        outputs := net.Predict(inputs)
        best := 0
        highest := 0.0
        for i := 0; i < net.Outputs; i++ {
            if outputs.At(i, 0) > highest {
                best = i
                highest = outputs.At(i, 0)
            }
        }
        target, _ := strconv.Atoi(record[0])
        if best == target {
            score++
        }
    }

    elapsed := time.Since(t1)
    fmt.Printf("Time taken to check: %s\n", elapsed)
    fmt.Println("score:", score)
}
```

### Prediction pipeline

<Steps>
  <Step title="Load model weights">
    The `load` function reads the trained weights from `data/hweights.model` and `data/oweights.model`.
  </Step>
  
  <Step title="Preprocess input data">
    Each pixel value (0-255) is normalized to a range of 0.01 to 0.99:
    
    ```go
    inputs[i] = (x / 255.0 * 0.99) + 0.01
    ```
    
    <Note>
      This preprocessing matches the training normalization, ensuring consistent input distribution.
    </Note>
  </Step>
  
  <Step title="Forward propagation">
    The `net.Predict(inputs)` method performs forward propagation through the network:
    
    1. Input layer (784 neurons) → Hidden layer (200 neurons)
    2. Apply sigmoid activation
    3. Hidden layer → Output layer (10 neurons)
    4. Apply sigmoid activation
    
    The output is a 10×1 matrix with confidence scores for each digit (0-9).
  </Step>
  
  <Step title="Select best prediction">
    The digit with the highest output value is selected as the prediction:
    
    ```go
    for i := 0; i < net.Outputs; i++ {
        if outputs.At(i, 0) > highest {
            best = i
            highest = outputs.At(i, 0)
        }
    }
    ```
  </Step>
  
  <Step title="Compare with ground truth">
    The prediction is compared against the actual label from the test set, and the score is incremented for correct predictions.
  </Step>
</Steps>

## Understanding the output

The network outputs 10 values representing the confidence for each digit:

```
Index 0: Confidence this is a "0"
Index 1: Confidence this is a "1"
...
Index 9: Confidence this is a "9"
```

The index with the highest confidence becomes the final prediction.

<Warning>
  Make sure the MNIST test dataset is in CSV format and located at `mnist_dataset/mnist_test.csv`. The first column should contain the label, followed by 784 pixel values.
</Warning>

## Performance considerations

- **Test set size**: 10,000 images
- **Typical evaluation time**: 2-5 seconds (depending on hardware)
- **Expected accuracy**: ~97% with proper training (5 epochs, 60,000 training samples)
- **Memory usage**: Model weights require approximately 1.5 MB

## Next steps

Once you've validated your model's accuracy on the test set, you can try making predictions on custom images. See the [Custom images](/inference/custom-images) guide to learn how to predict handwritten digits from your own 28×28 PNG files.